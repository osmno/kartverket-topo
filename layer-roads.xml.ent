<Style name="bridges-casing">
  <Rule>
    <Filter>&major_road;</Filter>
    &maxscale_zoom11;
    &minscale_zoom12;
    <LineSymbolizer>
      <CssParameter name="stroke">&black;</CssParameter>
      <CssParameter name="stroke-width">3.2</CssParameter>
      <CssParameter name="stroke-linecap">butt</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&major_road;</Filter>
      &maxscale_zoom14;
        <LineSymbolizer>
        <CssParameter name="stroke">&black;</CssParameter>
        <CssParameter name="stroke-width">6.4</CssParameter>
        <CssParameter name="stroke-linecap">butt</CssParameter>
      </LineSymbolizer>
    </Rule>
     <Rule>
      <Filter>&minor_road; or &residential_road; or &service_road; or &track; or &cycle_track;</Filter>
      &maxscale_zoom13;
        <LineSymbolizer>
        <CssParameter name="stroke">&black;</CssParameter>
        <CssParameter name="stroke-width">2</CssParameter>
        <CssParameter name="stroke-linecap">butt</CssParameter>
      </LineSymbolizer>
    </Rule>
     <Rule>
      <Filter>&path;</Filter>
      &maxscale_zoom13;
        <LineSymbolizer>
        <CssParameter name="stroke">&black;</CssParameter>
        <CssParameter name="stroke-width">2</CssParameter>
        <CssParameter name="stroke-linecap">butt</CssParameter>
      </LineSymbolizer>
    </Rule>
     <Rule>
      <Filter>&railway; or &tram;</Filter>
      &maxscale_zoom13;
        <LineSymbolizer>
        <CssParameter name="stroke">&black;</CssParameter>
        <CssParameter name="stroke-width">3</CssParameter>
        <CssParameter name="stroke-linecap">butt</CssParameter>
      </LineSymbolizer>
    </Rule>
</Style>

<Style name="tunnels-core">
    <Rule>
      <Filter>&major_road;</Filter>
      &maxscale_zoom10;
      &minscale_zoom11;
      <LineSymbolizer>
        <CssParameter name="stroke">&grey50;</CssParameter>
        <CssParameter name="stroke-width">2</CssParameter>
        <CssParameter name="stroke-dasharray">3,3</CssParameter>
      </LineSymbolizer>
    </Rule>
    <Rule>
      <Filter>&major_road;</Filter>
      &maxscale_zoom12;
      <LineSymbolizer>
        <CssParameter name="stroke">&grey50;</CssParameter>
        <CssParameter name="stroke-width">3</CssParameter>
        <CssParameter name="stroke-dasharray">3,3</CssParameter>
      </LineSymbolizer>
    </Rule>
    <Rule>
      <Filter>&minor_road; or &residential_road;</Filter>
      &maxscale_zoom12;
      &minscale_zoom12;
      <LineSymbolizer>
        <CssParameter name="stroke">&grey50;</CssParameter>
        <CssParameter name="stroke-width">1</CssParameter>
        <CssParameter name="stroke-dasharray">3,2</CssParameter>
      </LineSymbolizer>
    </Rule>
    <Rule>
      <Filter>&minor_road; or &residential_road; or &service_road;</Filter>
      &maxscale_zoom13;
      <LineSymbolizer>
        <CssParameter name="stroke">&grey50;</CssParameter>
        <CssParameter name="stroke-width">2</CssParameter>
        <CssParameter name="stroke-dasharray">3,3</CssParameter>
      </LineSymbolizer>
    </Rule>
    <Rule>
      <Filter>&track; or &cycle_track; or &path;</Filter>
      &maxscale_zoom13;
      <LineSymbolizer>
        <CssParameter name="stroke">&grey50;</CssParameter>
        <CssParameter name="stroke-width">1</CssParameter>
        <CssParameter name="stroke-dasharray">3,2</CssParameter>
      </LineSymbolizer>
    </Rule>
</Style>

<Style name="trams-casing">
  <Rule>
    <Filter>&tram; and not &tunnel;</Filter>
    &maxscale_zoom12;
    &minscale_zoom13;
    <LineSymbolizer>
      <CssParameter name="stroke">&black;</CssParameter>
      <CssParameter name="stroke-width">1.5</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
    </LineSymbolizer>
  </Rule>
 <Rule>
    <Filter>&tram; and not &tunnel;</Filter>
    &maxscale_zoom14;
    <LineSymbolizer>
      <CssParameter name="stroke">&black;</CssParameter>
      <CssParameter name="stroke-width">3</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
    </LineSymbolizer>
  </Rule>
</Style>

<Style name="roads-casing">
  <Rule>
   <Filter>&major_road; and not &tunnel;</Filter>
    &maxscale_zoom17;
    <LineSymbolizer>
      <CssParameter name="stroke">&road-casing-color;</CssParameter>
      <CssParameter name="stroke-width">5.2</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&minor_road; and not &tunnel;</Filter>
    &maxscale_zoom17;
    <LineSymbolizer>
      <CssParameter name="stroke">&road-casing-color;</CssParameter>
      <CssParameter name="stroke-width">4</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
    </LineSymbolizer>
  </Rule>
</Style>

<Style name="trams-core">
  <Rule>
    &maxscale_zoom12;
    &minscale_zoom13;
    <Filter>&tram; and not &tunnel;</Filter>
    <LineSymbolizer>
      <CssParameter name="stroke">&black;</CssParameter>
      <CssParameter name="stroke-width">1.0</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    &maxscale_zoom14;
    <Filter>&tram; and not &tunnel;</Filter>
    <LineSymbolizer>
      <CssParameter name="stroke">&black;</CssParameter>
      <CssParameter name="stroke-width">2.5</CssParameter>
    </LineSymbolizer>
  </Rule>
</Style>

<Style name="roads-core">
  <Rule>
    <Filter>&major_road;<!-- and not &tunnel;--></Filter>
    &maxscale_zoom8;
    &minscale_zoom9;
    <LineSymbolizer>
      <CssParameter name="stroke">&road-major-color;</CssParameter>
      <CssParameter name="stroke-width">0.7</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&major_road; and not &tunnel;</Filter>
    &maxscale_zoom10;
    &minscale_zoom11;
    <LineSymbolizer>
      <CssParameter name="stroke">&road-major-color;</CssParameter>
      <CssParameter name="stroke-width">1.6</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&major_road; and not &tunnel;</Filter>
    &maxscale_zoom12;
    &minscale_zoom13;
    <LineSymbolizer>
      <CssParameter name="stroke">&road-major-color;</CssParameter>
      <CssParameter name="stroke-width">1.6</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&major_road; and not &tunnel;</Filter>
    &maxscale_zoom14;
    <LineSymbolizer>
      <CssParameter name="stroke">&road-major-color;</CssParameter>
      <CssParameter name="stroke-width">3.2</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&minor_road; and not &tunnel;</Filter>
    &maxscale_zoom10;
    &minscale_zoom11;
    <LineSymbolizer>
      <CssParameter name="stroke">&road-color;</CssParameter>
      <CssParameter name="stroke-width">0.7</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&minor_road; and not &tunnel;</Filter>
    &maxscale_zoom12;
    &minscale_zoom13;
    <LineSymbolizer>
      <CssParameter name="stroke">&road-color;</CssParameter>
      <CssParameter name="stroke-width">1.2</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&minor_road; and not &tunnel;</Filter>
    &maxscale_zoom14;
    <LineSymbolizer>
      <CssParameter name="stroke">&road-color;</CssParameter>
      <CssParameter name="stroke-width">2</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&residential_road; and not &tunnel;</Filter>
    &maxscale_zoom12;
    &minscale_zoom12;
    <LineSymbolizer>
      <CssParameter name="stroke">&road-color;</CssParameter>
      <CssParameter name="stroke-width">0.9</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&residential_road; and not &tunnel;</Filter>
    &maxscale_zoom13;
    &minscale_zoom13;
    <LineSymbolizer>
      <CssParameter name="stroke">&road-color;</CssParameter>
      <CssParameter name="stroke-width">1.2</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&residential_road; and not &tunnel;</Filter>
    &maxscale_zoom14;
    &minscale_zoom14;
    <LineSymbolizer>
      <CssParameter name="stroke">&road-color;</CssParameter>
      <CssParameter name="stroke-width">2.2</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&residential_road; and not &tunnel;</Filter>
    &maxscale_zoom15;
    <LineSymbolizer>
      <CssParameter name="stroke">&road-color;</CssParameter>
      <CssParameter name="stroke-width">3</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&service_road; and not &tunnel;</Filter>
    &maxscale_zoom12;
    &minscale_zoom13;
    <LineSymbolizer>
      <CssParameter name="stroke">&road-color;</CssParameter>
      <CssParameter name="stroke-width">0.875</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&service_road; and not &tunnel;</Filter>
    &maxscale_zoom14;
    &minscale_zoom14;
    <LineSymbolizer>
      <CssParameter name="stroke">&road-color;</CssParameter>
      <CssParameter name="stroke-width">1.75</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&service_road; and not &tunnel;</Filter>
    &maxscale_zoom15;
    <LineSymbolizer>
      <CssParameter name="stroke">&road-color;</CssParameter>
      <CssParameter name="stroke-width">2</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
    </LineSymbolizer>
  </Rule>

  <Rule>
    <Filter>&railway; and not &tunnel;</Filter>
    &maxscale_zoom10;
    &minscale_zoom13;
    <LineSymbolizer>
      <CssParameter name="stroke">&black;</CssParameter>
      <CssParameter name="stroke-width">0.9</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&railway; and not &tunnel;</Filter>
    &maxscale_zoom14;
    <LineSymbolizer>
      <CssParameter name="stroke">&black;</CssParameter>
      <CssParameter name="stroke-width">1.8</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&tram; and not &tunnel;</Filter>
    &maxscale_zoom12;
    &minscale_zoom13;
    <LineSymbolizer>
      <CssParameter name="stroke">&black;</CssParameter>
      <CssParameter name="stroke-width">0.5</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&tram; and not &tunnel;</Filter>
    &maxscale_zoom14;
    <LineSymbolizer>
      <CssParameter name="stroke">&black;</CssParameter>
      <CssParameter name="stroke-width">2</CssParameter>
    </LineSymbolizer>
  </Rule>

  <Rule>
    <Filter>&cycle_track; and not &tunnel;</Filter>
    &maxscale_zoom12;
    &minscale_zoom13;
    <LineSymbolizer>
      <CssParameter name="stroke">&cycleway-color;</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
      <CssParameter name="stroke-width">0.875</CssParameter>
      <CssParameter name="stroke-dasharray">6,1</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&cycle_track; and not &tunnel;</Filter>
    &maxscale_zoom14;
    <LineSymbolizer>
      <CssParameter name="stroke">&cycleway-color;</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
      <CssParameter name="stroke-width">1.75</CssParameter>
      <CssParameter name="stroke-dasharray">12,3</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&track; and not &tunnel;</Filter>
    &maxscale_zoom12;
    &minscale_zoom13;
    <LineSymbolizer>
      <CssParameter name="stroke">&white;</CssParameter>
      <CssParameter name="stroke-width">0.75</CssParameter>
    </LineSymbolizer>
    <LineSymbolizer>
      <CssParameter name="stroke">&track-color;</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
      <CssParameter name="stroke-width">0.75</CssParameter>
      <CssParameter name="stroke-dasharray">5,2</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&track; and not &tunnel;</Filter>
    &maxscale_zoom14;
    <LineSymbolizer>
      <CssParameter name="stroke">&white;</CssParameter>
      <CssParameter name="stroke-width">1.5</CssParameter>
    </LineSymbolizer>
    <LineSymbolizer>
      <CssParameter name="stroke">&track-color;</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
      <CssParameter name="stroke-width">1.5</CssParameter>
      <CssParameter name="stroke-dasharray">10,4</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&path; and &marked_path; and not &tunnel;</Filter>
    &maxscale_zoom12;
    &minscale_zoom13;
    <LineSymbolizer>
      <CssParameter name="stroke">&trail-color;</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
      <CssParameter name="stroke-width">0.8</CssParameter>
      <CssParameter name="stroke-dasharray">3,3</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&path; and &marked_path; and not &tunnel;</Filter>
    &maxscale_zoom14;
    <LineSymbolizer>
      <CssParameter name="stroke">&trail-color;</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
      <CssParameter name="stroke-width">1.5</CssParameter>
      <CssParameter name="stroke-dasharray">6,6</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&path; and not &marked_path; and not &indistinct_path; and not &tunnel;</Filter>
    &maxscale_zoom12;
    &minscale_zoom13;
    <LineSymbolizer>
      <CssParameter name="stroke">&trail-color;</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
      <CssParameter name="stroke-width">0.4</CssParameter>
      <CssParameter name="stroke-dasharray">2,1</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&path; and not &marked_path; and not &indistinct_path; and not &tunnel;</Filter>
    &maxscale_zoom14;
    <LineSymbolizer>
      <CssParameter name="stroke">&trail-color;</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
      <CssParameter name="stroke-width">0.75</CssParameter>
      <CssParameter name="stroke-dasharray">4,2</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&path; and &indistinct_path; and not &marked_path; and not &tunnel;</Filter>
    &maxscale_zoom13;
    &minscale_zoom13;
    <LineSymbolizer>
      <CssParameter name="stroke">&trail-color;</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
      <CssParameter name="stroke-width">0.25</CssParameter>
      <CssParameter name="stroke-dasharray">2,1,2,3</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>&path; and &indistinct_path; and not &marked_path; and not &tunnel;</Filter>
    &maxscale_zoom14;
    <LineSymbolizer>
      <CssParameter name="stroke">&trail-color;</CssParameter>
      <CssParameter name="stroke-linejoin">round</CssParameter>
      <CssParameter name="stroke-linecap">round</CssParameter>
      <CssParameter name="stroke-width">0.65</CssParameter>
      <CssParameter name="stroke-dasharray">4,2,4,6</CssParameter>
    </LineSymbolizer>
  </Rule>

  <Rule>
    <Filter>[aeroway] = 'runway'</Filter>
    &maxscale_zoom10;
    &minscale_zoom11;
    <LineSymbolizer>
      <CssParameter name="stroke">&white;</CssParameter>
      <CssParameter name="stroke-width">1.5</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>[aeroway] = 'runway'</Filter>
    &maxscale_zoom12;
    <LineSymbolizer>
      <CssParameter name="stroke">&white;</CssParameter>
      <CssParameter name="stroke-width">7</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>[aeroway] = 'taxiway'</Filter>
    &maxscale_zoom10;
    &minscale_zoom11;
    <LineSymbolizer>
      <CssParameter name="stroke">&white;</CssParameter>
      <CssParameter name="stroke-width">0.5</CssParameter>
    </LineSymbolizer>
  </Rule>
  <Rule>
    <Filter>[aeroway] = 'taxiway'</Filter>
    &maxscale_zoom12;
    <LineSymbolizer>
      <CssParameter name="stroke">&white;</CssParameter>
      <CssParameter name="stroke-width">3</CssParameter>
    </LineSymbolizer>
  </Rule>
</Style>

<Layer name="roads" status="on" srs="&osm2pgsql_projection;">
  <StyleName>trams-casing</StyleName>
  <StyleName>trams-core</StyleName>
  <StyleName>roads-casing</StyleName>
  <StyleName>roads-core</StyleName>
  <Datasource>
    &datasource-settings;
    <Parameter name="table">
    (select way,highway,railway,aeroway,trail_visibility,marked_trail,trailblazed,tracktype,
     case when tunnel in ('yes','true','1') then 'yes'::text else tunnel end as tunnel,
     case when bridge in ('yes','true','1') then 'yes'::text else bridge end as bridge
     from &prefix;_line
     where highway is not null
        or railway is not null
        or aeroway is not null
     order by z_order
    ) as roads
    </Parameter>
  </Datasource>
</Layer>

<Layer name="tunnels" status="on" srs="&osm2pgsql_projection;">
  <StyleName>tunnels-core</StyleName>
  <Datasource>
    &datasource-settings;
    <Parameter name="table">
    (select way,highway,tracktype from &prefix;_line
     where tunnel in ('yes','true','1')
     order by z_order
    ) as roads
    </Parameter>
  </Datasource>
</Layer>

<Layer name="bridges" status="on" srs="&osm2pgsql_projection;">
  <StyleName>bridges-casing</StyleName>
  <StyleName>trams-casing</StyleName>
  <StyleName>trams-core</StyleName>
  <StyleName>roads-casing</StyleName>
  <StyleName>roads-core</StyleName>
  <Datasource>
    <Parameter name="table">
    (select way,highway,railway,aeroway,trail_visibility,marked_trail,trailblazed,tracktype,bridge,tunnel
     from &prefix;_line
     where (highway is not null
            or aeroway in ('runway','taxiway')
            or railway is not null)
       and bridge not in ('no','false','0')
     order by z_order
    ) as roads
    </Parameter>
    &datasource-settings;
  </Datasource>
</Layer>
